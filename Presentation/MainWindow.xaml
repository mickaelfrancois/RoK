<?xml version="1.0" encoding="utf-8"?>
<Window x:Class="Rok.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="using:Rok"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:v="using:Rok.Pages"
        xmlns:c="using:Rok.Commons"
        mc:Ignorable="d"        
        Title="">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid>
        <Grid DataContext="{x:Bind ViewModel, FallbackValue={x:Null}}">
            <Grid x:Name="MainGrid"
                  Visibility="Collapsed">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto"
                                   x:Name="PlayerRow" />
                </Grid.RowDefinitions>

                <NavigationView x:Name="navMenu"
                                Background="{ThemeResource NavigationViewExpandedPaneBackground}"
                                IsSettingsVisible="True"
                                IsBackButtonVisible="Auto"
                                IsBackEnabled="True"
                                ItemInvoked="NavigationView_ItemInvoked"
                                BackRequested="NavigationView_BackRequested"
                                Loaded="NavigationView_Loaded"
                                AlwaysShowHeader="False"
                                PaneDisplayMode="Top"
                                ExpandedModeThresholdWidth="500"
                                SelectionFollowsFocus="Enabled"
                                IsTabStop="False">

                    <NavigationView.Resources>
                        <Storyboard x:Name="IconRotation"
                                    AutoReverse="False"
                                    RepeatBehavior="Forever">
                            <DoubleAnimation Duration="0:0:1"
                                             From="0"
                                             To="360"
                                             Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)"
                                             Storyboard.TargetName="libraryRefresh" />
                        </Storyboard>
                    </NavigationView.Resources>

                    <NavigationView.MenuItems>
                        <NavigationViewItem x:Uid="menuAlbums"
                                            Tag="Albums"
                                            x:Name="albumsItem">
                            <NavigationViewItem.Icon>
                                <FontIcon Glyph="&#xe93c;"
                                          FontFamily="Segoe Fluent Icons" />
                            </NavigationViewItem.Icon>
                        </NavigationViewItem>
                        <NavigationViewItem x:Uid="menuArtists"
                                            Tag="Artists"
                                            x:Name="artistsItem"
                                            Icon="People" />
                        <NavigationViewItem x:Uid="menuTracks"
                                            Tag="Tracks"
                                            x:Name="tracksItem">
                            <NavigationViewItem.Icon>
                                <SymbolIcon Symbol="Audio" />
                            </NavigationViewItem.Icon>
                        </NavigationViewItem>
                        <NavigationViewItem x:Uid="menuPlaylists"
                                            Tag="Playlists"
                                            x:Name="playlistItem">
                            <NavigationViewItem.Icon>
                                <SymbolIcon Symbol="Shop" />
                            </NavigationViewItem.Icon>
                        </NavigationViewItem>
                    </NavigationView.MenuItems>

                    <NavigationView.AutoSuggestBox>
                        <AutoSuggestBox x:Uid="searchBox"
                                        x:Name="searchBox"
                                        QueryIcon="Find"
                                        AutomationProperties.Name="Search"
                                        QuerySubmitted="SearchBox_QuerySubmitted"
                                        CornerRadius="10"
                                        Text="{x:Bind ViewModel.Keyword, Mode=TwoWay}" />
                    </NavigationView.AutoSuggestBox>

                    <NavigationView.PaneHeader>
                        <StackPanel Orientation="Horizontal">
                            <ImageIcon Source="/Assets/logo.png"
                                       Margin="0,0,4,0"
                                       Height="25"
                                       Width="25" />
                            <TextBlock FontFamily="Consolas"
                                       FontWeight="Bold"
                                       FontSize="24"
                                       Text="RoK"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                    </NavigationView.PaneHeader>

                    <Frame x:Name="ContentFrame"
                           Margin="0">
                        <Frame.Transitions>
                            <TransitionCollection>
                                <NavigationThemeTransition />
                            </TransitionCollection>
                        </Frame.Transitions>
                    </Frame>

                    <NavigationView.FooterMenuItems>
                        <NavigationViewItem x:Uid="libraryRefreshButton"
                                            x:Name="libraryRefreshButton"
                                            SelectsOnInvoked="False"
                                            AutomationProperties.Name="refresh"
                                            Visibility="Visible"
                                            Tapped="LibraryRefreshButton_Tapped">
                            <NavigationViewItem.Icon>
                                <FontIcon Glyph="&#xE72C;"
                                          RenderTransformOrigin="0.5,0.5"
                                          x:Name="libraryRefresh">
                                    <FontIcon.RenderTransform>
                                        <RotateTransform Angle="0" />
                                    </FontIcon.RenderTransform>
                                </FontIcon>
                            </NavigationViewItem.Icon>
                        </NavigationViewItem>

                        <NavigationViewItem x:Uid="toggleTheme"
                                            x:Name="toggleTheme"
                                            SelectsOnInvoked="False"
                                            Tapped="ToggleTheme_Tapped"
                                            ToolTipService.ToolTip="">
                            <NavigationViewItem.Icon>
                                <FontIcon Glyph="&#xE793;" />
                            </NavigationViewItem.Icon>
                        </NavigationViewItem>

                    </NavigationView.FooterMenuItems>

                </NavigationView>

                <!-- Player -->
                <Border Grid.Row="1"
                        x:Name="HorizontalPlayer"
                        Background="#FF1F1F1F"
                        VerticalAlignment="Bottom"
                        HorizontalAlignment="Stretch"
                        Visibility="{Binding PlayerVisible, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                    <v:PlayerView x:Name="HorizontalPlayerView"
                                  HorizontalAlignment="Stretch"></v:PlayerView>
                </Border>
            </Grid>

            <Grid x:Name="FullScreenGrid"
                  Visibility="Collapsed"
                  Margin="0,25,0,0">
                <c:FullScreenControl x:Name="fullscreen"></c:FullScreenControl>
            </Grid>

            <Grid x:Name="gridCompactScreen"
                  Visibility="Collapsed">
                <c:CompactPlayerControl></c:CompactPlayerControl>
            </Grid>

            <c:SplashScreenControl x:Name="SplashScreen"
                                   Visibility="Visible"></c:SplashScreenControl>
        </Grid>

        <c:NotificationControl x:Name="notificationControl"
                               VerticalAlignment="Top"
                               HorizontalAlignment="Right"
                               Canvas.ZIndex="9999"
                               Margin="0,20,20,0" />
    </Grid>
</Window>
